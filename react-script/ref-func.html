<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>String Ref</title>
  </head>
  <body>
    <div id="root"></div>
    <script src="https://cdn.bootcdn.net/ajax/libs/react/16.8.6/umd/react.production.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/react-dom/16.8.6/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.staticfile.org/babel-standalone/6.26.0/babel.min.js"></script>

    <script type="text/babel">
      class Demo extends React.Component {
        handleClick = () => {
          // 字符串类型的 ref 存在一定的效率问题 不推荐使用
          // 回调 ref 存在的问题
          // 如果你的ref回调是通过 内联函数的形式定义的 那么在组件更新的时候 他会被调用两次 第一次传递的值是null 第二次传递的值才是我们的
          // DOM 元素
          // 真是因为每次更新的时候都会创建一个新的函数实例 所以 React 会清空旧的 ref 并设置新的 但是在我们的使用上没有什么大的影响
          const { leftInput, rightInput } = this;
          console.log(leftInput, rightInput);
        };
        saveInput = input => {
          this.rightInput = input;
        };
        render() {
          return (
            <div>
              <input
                ref={input => {
                  this.leftInput = input;
                }}
                type="text"
                placeholder="左侧数据"
              />
              &nbsp;
              <button onClick={this.handleClick}>Click Show Data</button>
              &nbsp;
              {/* 解决方式 使用类方法解决 内联函数被调用两次的问题*/}
              <input ref={this.saveInput} type="text" placeholder="右侧数据" />
            </div>
          );
        }
      }
      // React 发现你的组件是一个函数 那么会自动调用一个函数 将函数返回的虚拟DOM转换为真实的DOM渲染出来
      ReactDOM.render(<Demo />, document.getElementById("root"));
    </script>
  </body>
</html>
